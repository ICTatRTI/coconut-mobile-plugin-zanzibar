{
  "_id": "Household",
  "collection": "question",
  "couchapp": {},
  "isApplicationDoc": true,
  "action_on_questions_loaded": "window.malariaCase = new Case({caseID: Coconut.questionView.result.get 'MalariaCaseID'});malariaCase.fetch() if malariaCase.caseID",
  "onValidatedComplete": "malariaCase.createNextResult()",
  "questions": [
    {
      "action_on_change": "if (ResultOfQuestion('Malaria Case ID') is null and value is 'Mass Screen') then setValue('Malaria Case ID', moment().format('YYMD') + Math.floor(Math.random()*100000))",
      "label": "Reason for visiting household",
      "radio-options": "Index Case Household, Index Case Neighbors, Mass Screen",
      "type": "radio"
    },
    {
      "label": "Malaria Case ID",
      "type": "text"
    },
    {
      "label": "Head of Household Name",
      "type": "autocomplete from previous entries"
    },
    {
      "autocomplete-options": "window.ShehiaOptions = GeoHierarchy.allUniqueShehiaNames()",
      "label": "Shehia",
      "type": "autocomplete from code",
      "validation": "'Shehia ' + value + ' is not valid. Please try again.' unless _.contains(window.ShehiaOptions, value)"
    },
    {
      "label": "Village",
      "type": "autocomplete from previous entries"
    },
    {
      "label": "Sheha/Mjumbe",
      "type": "autocomplete from previous entries"
    },
    {
      "label": "Contact Mobile # (patient/relative)",
      "type": "text"
    },
    {
      "label": "Household Location",
      "required": "false",
      "type": "location"
    },
    {
      "label": "<span style='background:yellow'>Household in high risk shehia and index case has no travel history, recommend followup at nearby households</span>",
      "skip_logic": "if window.currentCase then not(window.currentCase.indexCaseHasNoTravelHistory() and window.currentCase.highRiskShehia()) else true",
      "type": "label"
    },
    {
      "label": "Followup Neighbors?",
      "radio-options": "Yes,No",
      "type": "radio"
    },
    {
      "label": "Number of other households within 50 steps of index case household",
      "radio-options": "Yes,No",
      "skip_logic": "ResultOfQuestion('Followup Neighbors?') is 'No'",
      "type": "number"
    },
    {
      "label": "Total Number of Residents in the Household",
      "type": "number",
      "validation": "return 'Value must be between 0 and 20' if value < 0 or value > 20"
    },
    {
      "label": "Number of LLIN",
      "type": "number",
      "validation": "return 'Value must be between 0 and 20' if value < 0 or value > 20"
    },
    {
      "label": "Number of Sleeping Places (beds/mattresses)",
      "type": "number",
      "validation": "return 'Value must be between 0 and 20' if value < 0 or value > 20"
    },
    {
      "label": "Have you given coupon(s) for nets",
      "radio-options": "Yes,No",
      "skip_logic": "ResultOfQuestion('Number of LLIN') >= ResultOfQuestion('Number of Sleeping Places (beds/mattresses)')",
      "type": "radio"
    },
    {
      "label": "Coupon Numbers",
      "required": "false",
      "skip_logic": "ResultOfQuestion('Have you given coupon(s) for nets') is null or ResultOfQuestion('Have you given coupon(s) for nets') is 'No' ",
      "type": "text"
    },
    {
      "label": "Number of Household Members with Fever or History of Fever Within Past Week",
      "type": "number",
      "validation": "return 'Value must be between 0 and 20' if value < 0 or value > 20"
    },
    {
      "label": "Number of Household Members Treated for Malaria Within Past Week",
      "type": "number",
      "validation": "return 'Value must be between 0 and 20' if value < 0 or value > 20"
    },
    {
      "label": "Index case: If patient is female 15-45 years of age, is she is pregant?",
      "radio-options": "Yes,No,Unknown,Not Applicable",
      "skip_logic": "ResultOfQuestion('Reason for visiting household') isnt 'Index Case Household'",
      "type": "radio"
    },
    {
      "label": "Index case: Patient's current status",
      "radio-options": "Feeling Better, Feeling Unchanged, Feeling Worse, Admitted, Died ",
      "skip_logic": "ResultOfQuestion('Reason for visiting household') isnt 'Index Case Household'",
      "type": "radio"
    },
    {
      "label": "Index case: Patient's treatment status",
      "radio-options": "Completed, In Progress, Stopped",
      "skip_logic": "ResultOfQuestion('Reason for visiting household') isnt 'Index Case Household'",
      "type": "radio"
    },
    {
      "label": "Index case: Slept under LLIN last night?",
      "radio-options": "Yes,No,Unknown,Not Applicable",
      "skip_logic": "ResultOfQuestion('Reason for visiting household') isnt 'Index Case Household'",
      "type": "radio"
    },
    {
      "_id": "3768",
      "action_on_questions_loaded": "_.delay( (-> start = moment(currentCase.indexCaseDiagnosisDate()).subtract(24,'days').format('Do of MMM, YYYY');end = moment(currentCase.indexCaseDiagnosisDate()).subtract(10,'days').format('Do of MMM, YYYY');$('label[for=3768]').html($('label[for=3768]').html().replace(/Zanzibar.*/, 'Zanzibar between the ' + start + ' and ' + end))), 2000)",
      "id": "3768",
      "label": "Index case: Overnight Travel within Zanzibar 10-24 days before positive test result",
      "radio-options": "Yes,No,Unknown,Not Applicable",
      "skip_logic": "ResultOfQuestion('Reasonforvisitinghousehold') isnt 'Index Case Household'",
      "type": "radio"
    },
    {
      "_id": "3769",
      "action_on_questions_loaded": "_.delay( (-> start = moment(currentCase.indexCaseDiagnosisDate()).subtract(24,'days').format('Do of MMM, YYYY');end = moment(currentCase.indexCaseDiagnosisDate()).subtract(10,'days').format('Do of MMM, YYYY');$('label[for=3769]').html($('label[for=3769]').html().replace(/Zanzibar.*/, 'Zanzibar between the ' + start + ' and ' + end))), 2000); new HouseholdLocationSelectorView($('#3769')); $('#3769').prop('readonly',true)",
      "id": "3769",
      "label": "List all locations of overnight travel within Zanzibar 10-24 days before positive test result",
      "skip_logic": "ResultOfQuestion('IndexcaseOvernightTravelwithinZanzibar1024daysbeforepositivetestresult') isnt 'Yes'",
      "type": "text"
    },
    {
      "_id": "4769",
      "id": "4769",
      "label": "Index case: Overnight Travel outside of Zanzibar in the past year?",
      "radio-options": "Yes,No,Unknown,Not Applicable",
      "skip_logic": "ResultOfQuestion('Reasonforvisitinghousehold') isnt 'Index Case Household'",
      "type": "radio"
    },
    {
      "_id": "5769",
      "action_on_questions_loaded": "window.updateOutsideZanzibarLabel = ((element,startDays,endDays) -> _.delay( (-> start = moment(currentCase.indexCaseDiagnosisDate()).subtract(startDays,'days');end = moment(currentCase.indexCaseDiagnosisDate()).subtract(endDays,'days');$(element).html($(element).html().replace(/Zanzibar.*/, 'Zanzibar between the ' + start.format('Do of MMM, YYYY') + ' (' + start.fromNow()  + ') and ' + end.format('Do of MMM, YYYY') + ' (' + end.fromNow() + ')' ))), 2000)); updateOutsideZanzibarLabel('label[for=5769]',7,0); new HouseholdLocationSelectorView($('#5769')); $('#5769').prop('readonly',true)",
      "id": "5769",
      "label": "All locations and entry points from overnight travel outside Zanzibar 0-7 days before positive test result ",
      "required": false,
      "skip_logic": "ResultOfQuestion('IndexcaseOvernightTraveloutsideofZanzibarinthepastyear') isnt 'Yes'",
      "type": "text"
    },
    {
      "_id": "5739",
      "action_on_questions_loaded": "updateOutsideZanzibarLabel('label[for=5739]',14,8);new HouseholdLocationSelectorView($('#5739')); $('#5739').prop('readonly',true)",
      "id": "5739",
      "label": "All locations and entry points from overnight travel outside Zanzibar 8-14 days before positive test result ",
      "required": false,
      "skip_logic": "ResultOfQuestion('IndexcaseOvernightTraveloutsideofZanzibarinthepastyear') isnt 'Yes'",
      "type": "text"
    },
    {
      "_id": "6739",
      "action_on_questions_loaded": "updateOutsideZanzibarLabel('label[for=6739]',21,15);new HouseholdLocationSelectorView($('#6739')); $('#6739').prop('readonly',true)",
      "id": "6739",
      "label": "All locations and entry points from overnight travel outside Zanzibar 15-21 days before positive test result ",
      "required": false,
      "skip_logic": "ResultOfQuestion('IndexcaseOvernightTraveloutsideofZanzibarinthepastyear') isnt 'Yes'",
      "type": "text"
    },
    {
      "_id": "7739",
      "action_on_questions_loaded": "updateOutsideZanzibarLabel('label[for=7739]',42,22);new HouseholdLocationSelectorView($('#7739')); $('#7739').prop('readonly',true)",
      "id": "7739",
      "label": "All locations and entry points from overnight travel outside Zanzibar 22-42 days before positive test result ",
      "required": false,
      "skip_logic": "ResultOfQuestion('IndexcaseOvernightTraveloutsideofZanzibarinthepastyear') isnt 'Yes'",
      "type": "text"
    },
    {
      "_id": "8739",
      "action_on_questions_loaded": "updateOutsideZanzibarLabel('label[for=8739]',365,43);new HouseholdLocationSelectorView($('#8739')); $('#8739').prop('readonly',true)",
      "id": "8739",
      "label": "All locations and entry points from overnight travel outside Zanzibar 43-365 days before positive test result ",
      "required": false,
      "skip_logic": "ResultOfQuestion('IndexcaseOvernightTraveloutsideofZanzibarinthepastyear') isnt 'Yes'",
      "type": "text"
    },
    {
      "label": "Last date of IRS",
      "required": false,
      "type": "date"
    },
    {
      "label": "complete",
      "type": "checkbox"
    }
  ],
  "resultSummaryFields": {
    "Head of Household Name": "on",
    "Malaria Case ID": "on",
    "Total Number of Residents in the Household": "on"
  }
}
